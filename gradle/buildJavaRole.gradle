subprojects {
    afterEvaluate { project ->
        if (!project.hasProperty('roles')) {
            return
        }
        def projectRoles = (String[]) ext.roles

        if (projectRoles.contains('java')) {
            logger.warn('Configuring ' + name + ' with \'java\' role')

            project.sourceCompatibility = '1.10'
            project.targetCompatibility = '1.10'

            //connect to remote package repositories
            repositories {
                mavenLocal()
                mavenCentral()
                jcenter()
            }

            //ensure that project state is valid before issue a new tag
            reckonTagCreate.dependsOn check

            //provide compartible module name in the JAR manifest
            jar {
                inputs.property("moduleName", moduleName)
                manifest {
                    attributes('Automatic-Module-Name': moduleName)
                }
            }
        }
    }
}